<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<div id="userInfo">
    <ul>
        <li>
            <label for="username">
                <input type="text" id="username" name="username" placeholder="姓名" autofocus="autofocus" maxlength=10 minlength=2 required="required" />
            </label>
        </li>
        <li>
            <label for="phone">
                <input type="tel" id="phone" name="phone" placeholder="手机" required="required" />
            </label>
        </li>
        <li>
            <select id="ddlProvince" name="ddlProvince" style="width: 66px" class="w50" ></select>
            <select id="ddlCity" name="ddlCity" class="w50" >
                <option value="-1">城市</option>
            </select>
        </li>
        <li>
            <select id="agency" name="agency" style="width: 66px" class="w50" >
                <option value="-1">--经销商--</option>
                <option value="1">经销商1</option>
                <option value="2">经销商2</option>
                <option value="3">经销商3</option>
            </select>
        </li>
        <li>
            <select name="cartype" id="cartype">
                <option value="-1">--意向车型--</option>
                <option value="4008">4008</option>
                <option value="3008">3008</option>
                <option value="2008">2008</option>
            </select>
        </li>
        <li><button id="btn-userInfo">提交</button></li>
    </ul>
</div>
</body>
<script src="js/jquery-1.8.3.min.js"></script>
<script src="js/province.js"></script>
<script>
    var SaveInfo = {
        username:null,
        phone:null,
        province:null,
        city:null,
        agency:null,
        cartype:null,
        init:function(){
            this.updateView();
        },
        updateView:function(){
            SaveInfo.inputReg();
            SaveInfo.submit();
        },
        inputReg:function(){
            $('input[name="username"]').blur(function(){
//				console.log(this.validity);
                if(this.validity.valid){
                    $('input[name="username"]').removeClass('red');
                }else{
                    $('input[name="username"]').addClass('red');
                }
            });
            $('input[name="username"]').focus(function(){
                if(this.validity.valid) {
                    $('input[name="username"]').removeClass('red');
                }else{
                    $('input[name="username"]').addClass('red');
                }
            });
            $('input[name="phone"]').blur(function(){
                var reg = /^1[34578]\d{9}$/;
                var val = $(this).val();
                if(reg.test(val)){
                    $(this).removeClass('red');
                }else{
                    $(this).addClass('red');
                }
            });
            $('input[name="phone"]').focus(function(){
                $(this).keyup(function(){
                    if(this.validity.valid){
                        $(this).removeClass('red');
                    }else{
                        $(this).addClass('red');
                    }
                })
            });
        },
        clickReg:function(){
            var usernameReg = false,phoneReg = false,provinceReg = false,cityReg = false,agencyReg = false,cartypeReg = false;
            var inputUsername = document.getElementById('username');
            if(inputUsername.validity.valid){
                usernameReg = true;
            }else{
                usernameReg = false;
            }
            var reg = /^1[34578]\d{9}$/;
            if(reg.test($('input[name="phone"]').val())){
                phoneReg = true;
            }else{
                phoneReg = false;
            }
            function selectReg(selectName){
                var val = $('select[name='+selectName+'] option:selected').val();
                var reg;
                if(val&&val!=-1){
                    reg = true;
                }else{
                    reg = false;
                }
                return reg;
            }
            provinceReg = selectReg('ddlProvince');
            cityReg = selectReg('ddlCity');
            agencyReg = selectReg('agency');
            cartypeReg = selectReg('cartype');
            var total = usernameReg&&phoneReg&&provinceReg&&cityReg&&agencyReg&&cartypeReg;
            console.log(usernameReg,phoneReg,provinceReg,cityReg,agencyReg,cartypeReg);
//			return total;
            return true;
        },
        submit:function(){
            $('#btn-userInfo').click(function(e){
                e.preventDefault();
                if(SaveInfo.clickReg()){
                    SaveInfo.username = $('input[name="username"]').val();
                    SaveInfo.phone = $('input[name="phone"]').val();
                    SaveInfo.province = $('select[name="ddlProvince"] option:selected').val();
                    SaveInfo.city = $('select[name="ddlCity"] option:selected').val();
                    SaveInfo.agency = $('select[name="agency"] option:selected').val();
                    SaveInfo.cartype = $('select[name="cartype"] option:selected').val();
                    var data = {
                        username:SaveInfo.username,
                        phone:SaveInfo.phone,
                        province:SaveInfo.province,
                        city:SaveInfo.city,
                        agency:SaveInfo.agency,
                        cartype:SaveInfo.cartype
                    };
                    console.log(data);
//					$.ajax({
//						url:'dddd',
//						type:'post',
//						data:data,
//						success:function(msg){
//							console.log(msg);
//							if(msg.Status==0){
//
//							}
//						}
//					})
                }
            })
        }
    };
    $(function(){
        ProvinceData.init('ddlProvince', 'ddlCity','agency');
        SaveInfo.init();

    })
</script>
</html>